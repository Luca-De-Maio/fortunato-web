---
import Base from "../../layouts/Base.astro";
import Header from "../../components/Header.astro";
import Footer from "../../components/Footer.astro";
import products from "../../../data/products.json";

export function getStaticPaths() {
  return products.map((product) => ({ params: { slug: product.slug }, props: { product } }));
}

const { product } = Astro.props;
const priceLabel = product.price ? `${product.currency} ${product.price}` : "Precio a confirmar";
---

<Base title={`Fortunato | ${product.name}`} description={product.description}>
  <Header />

  <main class="product-page">
    <div class="container product-grid">
      <div>
        <img src={product.images[0]} alt={product.name} loading="lazy" />
      </div>
      <div class="product-info">
        <p class="product-category">{product.category}</p>
        <h1>{product.name}</h1>
        <p class="product-price">{priceLabel}</p>
        <p class="muted">{product.description}</p>

        <div class="product-meta">
          <div>
            <p class="muted">Materiales</p>
            <div class="pill-list">
              {product.materials.map((item) => (
                <span class="pill">{item}</span>
              ))}
            </div>
          </div>
          <div>
            <p class="muted">Colores</p>
            <div class="pill-list">
              {product.colors.map((item) => (
                <span class="pill">{item}</span>
              ))}
            </div>
          </div>
          <div>
            <p class="muted">Talles</p>
            <div class="pill-list">
              {product.sizes.map((item) => (
                <span class="pill">{item}</span>
              ))}
            </div>
          </div>
        </div>

        <ul class="product-highlights">
          {product.highlights.map((item) => (
            <li>â€¢ {item}</li>
          ))}
        </ul>

        <div class="product-actions" style="margin-top: 1.4rem;">
          <button
            class="btn"
            data-add-to-cart
            data-id={product.id}
            data-name={product.name}
            data-price={product.price ?? 0}
            data-currency={product.currency}
            data-image={product.images[0]}
          >
            Agregar al carrito
          </button>
          <a href="/checkout" class="btn btn-ghost">Comprar ahora</a>
        </div>
      </div>
    </div>
  </main>

  <Footer />
</Base>
